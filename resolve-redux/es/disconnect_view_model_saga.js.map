{"version":3,"sources":["../src/disconnect_view_model_saga.js"],"names":["put","getHash","dropViewModelState","CONNECT_VIEWMODEL","unsubscribeViewModelTopicsSaga","disconnectViewModelSaga","sagaArgs","action","viewModels","connectionManager","sagaManager","sagaKey","viewModelName","aggregateIds","aggregateArgs","connectionId","removeConnection","connectionName","removedConnections","length","stop"],"mappings":";AAAA,SAASA,GAAT,QAAoB,oBAApB;AAEA,OAAOC,OAAP,MAAoB,YAApB;AACA,SAASC,kBAAT,QAAmC,WAAnC;AACA,SAASC,iBAAT,QAAkC,gBAAlC;AACA,OAAOC,8BAAP,MAA2C,sCAA3C;;AAEA,IAAMC,uBAAuB;AAAA;AAAA,yBAAG,SAA1BA,uBAA0B,CAAUC,QAAV,EAAoBC,MAApB;AAAA;;AAAA;AAAA;AAAA;AAAA;AACtBC,UAAAA,UADsB,GACkCF,QADlC,CACtBE,UADsB,EACVC,iBADU,GACkCH,QADlC,CACVG,iBADU,EACSC,WADT,GACkCJ,QADlC,CACSI,WADT,EACsBC,OADtB,GACkCL,QADlC,CACsBK,OADtB;AAGtBC,UAAAA,aAHsB,GAGyBL,MAHzB,CAGtBK,aAHsB,EAGPC,YAHO,GAGyBN,MAHzB,CAGPM,YAHO,EAGOC,aAHP,GAGyBP,MAHzB,CAGOO,aAHP;AAKxBC,UAAAA,YALwB,QAKNd,OAAO,CAACY,YAAD,CALD,GAKkBZ,OAAO,CAACa,aAAD,CALzB;AAAA,kCAOCL,iBAAiB,CAACO,gBAAlB,CAAmC;AAChEC,YAAAA,cAAc,EAAEL,aADgD;AAEhEG,YAAAA,YAAY,EAAZA;AAFgE,WAAnC,CAPD,EAOtBG,kBAPsB,yBAOtBA,kBAPsB;;AAAA,gBAW1BA,kBAAkB,CAACC,MAAnB,KAA8B,CAXJ;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAe9B,wCAAOT,WAAW,CAACU,IAAZ,MAAoBjB,iBAApB,GAAwCQ,OAAxC,CAAP;;AAf8B;AAAA;AAiB9B,iBAAMX,GAAG,CAACE,kBAAkB,CAACU,aAAD,EAAgBC,YAAhB,EAA8BC,aAA9B,CAAnB,CAAT;;AAjB8B;AAmB9B,wCAAOV,8BAA8B,CAAC;AACpCI,YAAAA,UAAU,EAAVA,UADoC;AAEpCI,YAAAA,aAAa,EAAbA,aAFoC;AAGpCC,YAAAA,YAAY,EAAZA;AAHoC,WAAD,CAArC;;AAnB8B;AAAA;AAAA;AAAA;AAAA;AAAA,KAA1BR,uBAA0B;AAAA,CAAH,CAA7B;;AA0BA,eAAeA,uBAAf","sourcesContent":["import { put } from 'redux-saga/effects'\n\nimport getHash from './get_hash'\nimport { dropViewModelState } from './actions'\nimport { CONNECT_VIEWMODEL } from './action_types'\nimport unsubscribeViewModelTopicsSaga from './unsubscribe_view_model_topics_saga'\n\nconst disconnectViewModelSaga = function*(sagaArgs, action) {\n  const { viewModels, connectionManager, sagaManager, sagaKey } = sagaArgs\n\n  const { viewModelName, aggregateIds, aggregateArgs } = action\n\n  const connectionId = `${getHash(aggregateIds)}${getHash(aggregateArgs)}`\n\n  const { removedConnections } = connectionManager.removeConnection({\n    connectionName: viewModelName,\n    connectionId\n  })\n  if (removedConnections.length !== 1) {\n    return\n  }\n\n  yield* sagaManager.stop(`${CONNECT_VIEWMODEL}${sagaKey}`)\n\n  yield put(dropViewModelState(viewModelName, aggregateIds, aggregateArgs))\n\n  yield* unsubscribeViewModelTopicsSaga({\n    viewModels,\n    viewModelName,\n    aggregateIds\n  })\n}\n\nexport default disconnectViewModelSaga\n"],"file":"disconnect_view_model_saga.js"}